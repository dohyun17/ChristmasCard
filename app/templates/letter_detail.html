{% extends "base.html" %}

{% block content %}
<div class="christmas-container">
    <h1 class="christmas-title">âœ‰ï¸ {{ letter.sender }}ì˜ í¸ì§€ âœ‰ï¸</h1>
    
    <audio id="christmas-audio" autoplay loop>
        <source src="{{ url_for('static', filename='christmas_music.mp3') }}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <p><strong>í¸ì§€ ë‚´ìš©:</strong></p>
    <p class="letter-content">{{ letter.content }}</p>

    {% if letter.file %}
        <div class="file-preview">
            <p><strong>ì²¨ë¶€ íŒŒì¼:</strong> {{ letter.file }}</p>
            {% set file_extension = letter.file.split('.')[-1].lower() %}
            {% if file_extension in ['jpg', 'jpeg', 'png', 'gif'] %}
                <img src="{{ url_for('static', filename='uploads/' + letter.file) }}" alt="ì²¨ë¶€ ì´ë¯¸ì§€" class="attached-image">
            {% elif file_extension in ['pdf'] %}
                <embed src="{{ url_for('static', filename='uploads/' + letter.file) }}" type="application/pdf" width="100%" height="600px" />
            {% endif %}
            <a href="{{ url_for('static', filename='uploads/' + letter.file) }}" class="christmas-button" download>íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a>
        </div>
    {% endif %}

    <div class="button-group">
        <a href="{{ url_for('main.edit_letter', id=letter.id) }}" class="christmas-button">âœï¸ í¸ì§€ ìˆ˜ì •í•˜ê¸°</a>
        <form action="{{ url_for('main.delete_letter', id=letter.id) }}" method="POST" style="display: inline;">
            <button type="submit" class="christmas-button" onclick="return confirm('ì •ë§ë¡œ ì´ í¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ğŸ—‘ï¸ í¸ì§€ ì‚­ì œí•˜ê¸°</button>
        </form>
        <a href="{{ url_for('main.letter_list') }}" class="christmas-button">ğŸ“œ í¸ì§€ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <!-- ê³µìœ  ë²„íŠ¼ì„ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ë°°ì¹˜ -->
    <div class="share-button-container">
        <a href="#" class="small-christmas-button" onclick="shareOnFacebook()">Facebook</a>
        <a href="#" class="small-christmas-button" onclick="shareOnX()">X (Twitter)</a> <!-- X (Twitter)ë¡œ ë³€ê²½ -->
        <a href="#" class="small-christmas-button" onclick="shareViaEmail()">Email</a>
    </div>
</div>

<style>
.christmas-container {
    padding: 20px;
    position: relative; /* ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • */
}

.christmas-title {
    font-size: 24px;
    margin-bottom: 20px;
}

.letter-content {
    margin-bottom: 20px;
}

.file-preview {
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 5px;
    padding: 15px;
    margin-bottom: 20px;
}

.button-group {
    margin-top: 20px;
}

/* ì¼ë°˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.christmas-button {
    display: inline-block;
    padding: 12px 24px;
    margin-right: 10px;
    font-size: 16px;
    border: none;
    border-radius: 5px;
    color: white;
    text-align: center;
    text-decoration: none;
    background-color: #f44336;
}

.christmas-button:hover {
    background-color: #d32f2f;
}

/* ì‘ì€ ê³µìœ  ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.small-christmas-button {
    display: inline-block;
    padding: 5px; /* ì‘ê²Œ ì¡°ì • */
    font-size: 14px; /* ê¸€ì í¬ê¸° ì¡°ì • */
    border-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
    color: white; /* í°ìƒ‰ ê¸€ì */
    text-align: center; /* í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
    text-decoration: none; /* ë§í¬ ì¥ì‹ ì œê±° */
    background-color: #f44336; /* ë¹¨ê°„ìƒ‰ ë°°ê²½ */
}

/* ê³µìœ  ë²„íŠ¼ ìœ„ì¹˜ ì¡°ì • */
.share-button-container {
    position: absolute; /* ì ˆëŒ€ ìœ„ì¹˜ ì„¤ì • */
    top: 10px; /* ìƒë‹¨ì—ì„œì˜ ê±°ë¦¬ */
    right: 10px; /* ì˜¤ë¥¸ìª½ì—ì„œì˜ ê±°ë¦¬ */
}

.small-christmas-button:hover {
    background-color: #d32f2f; /* í˜¸ë²„ ì‹œ ì–´ë‘ìš´ ë¹¨ê°„ìƒ‰ */
}
</style>

<script>
function shareOnFacebook() {
    const shareUrl = "{{ url_for('main.letter_detail', id=letter.id, _external=True) }}";
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`, '_blank');
}

function shareOnX() { // Xë¡œ ì´ë¦„ ë³€ê²½
    const shareUrl = "{{ url_for('main.letter_detail', id=letter.id, _external=True) }}";
    const shareText = "Check out my Christmas letter!";
    window.open(`https://x.com/intent/tweet?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(shareText)}`, '_blank');
}

function shareViaEmail() {
    const shareUrl = "{{ url_for('main.letter_detail', id=letter.id, _external=True) }}";
    const shareText = "Check out my Christmas letter!";
    window.location.href = `mailto:?subject=${encodeURIComponent(shareText)}&body=${encodeURIComponent(shareUrl)}`;
}
</script>

{% endblock %}
