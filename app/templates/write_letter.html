{% extends "base.html" %}

{% block content %}
<div class="christmas-container">
    <h1 class="christmas-title">âœ‰ï¸ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ í¸ì§€ ì“°ê¸° âœ‰ï¸</h1>
    
    <form method="POST" class="christmas-form">
        <div class="form-group">
            <label for="sender">ë³´ë‚´ëŠ” ì‚¬ëŒ:</label>
            <input type="text" id="sender" name="sender" placeholder="ë‹¹ì‹ ì˜ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" required>
        </div>
        
        <div class="form-group">
            <label for="content">í¸ì§€ ë‚´ìš©:</label>
            <textarea id="content" name="content" rows="10" placeholder="ë”°ëœ»í•œ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë§ˆìŒì„ ë‹´ì•„ì£¼ì„¸ìš”" required></textarea>
        </div>

        <!-- ê°ì • í‘œí˜„ ë²„íŠ¼ -->
        <div class="emotion-container">
            <label>ê°ì • í‘œí˜„:</label>
            <button type="button" onclick="insertEmotion('ğŸ˜Š')">ğŸ˜Š</button>
            <button type="button" onclick="insertEmotion('â¤ï¸')">â¤ï¸</button>
            <button type="button" onclick="insertEmotion('ğŸ‰')">ğŸ‰</button>
            <button type="button" onclick="insertEmotion('ğŸ˜¢')">ğŸ˜¢</button>
            <button type="button" onclick="insertEmotion('ğŸ˜„')">ğŸ˜„</button>
            <button type="button" onclick="insertEmotion('âœ¨')">âœ¨</button>
            <button type="button" onclick="insertEmotion('ğŸ„')">ğŸ„</button>
            <button type="button" onclick="insertEmotion('ğŸŒŸ')">ğŸŒŸ</button>
        </div>

        <button type="submit" class="christmas-button">ğŸ„ í¸ì§€ ë³´ë‚´ê¸° ğŸ„</button>
    </form>
    
    <a href="{{ url_for('letter_list') }}" class="christmas-button">ğŸ“œ í¸ì§€ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>

    <!-- ìë™ ì €ì¥ ì•ˆë‚´ ë©”ì‹œì§€ -->
    <div id="autosaveMessage" style="display:none; color: green; margin-top: 10px;">
        ìë™ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!
    </div>
</div>

<script>
// ìë™ ì €ì¥ í•¨ìˆ˜
function autoSave() {
    const content = document.getElementById('content').value; // ì‚¬ìš©ì ì…ë ¥ ê°€ì ¸ì˜¤ê¸°
    localStorage.setItem('autosaveContent', content); // Local Storageì— ì €ì¥

    // ìë™ ì €ì¥ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
    const autosaveMessage = document.getElementById('autosaveMessage');
    autosaveMessage.style.display = 'block';

    // 2ì´ˆ í›„ì— ë©”ì‹œì§€ ìˆ¨ê¹€
    setTimeout(() => {
        autosaveMessage.style.display = 'none';
    }, 2000);
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ Local Storageì—ì„œ ë°ì´í„° ë³µì›
window.onload = function() {
    const savedContent = localStorage.getItem('autosaveContent');
    if (savedContent) {
        document.getElementById('content').value = savedContent;
    }
};

// 5ì´ˆë§ˆë‹¤ autoSave í•¨ìˆ˜ ì‹¤í–‰
setInterval(autoSave, 5000);

// ê°ì • í‘œí˜„ í•¨ìˆ˜
function insertEmotion(emotion) {
    const contentTextarea = document.getElementById('content');
    contentTextarea.value += emotion; // ì„ íƒí•œ ì´ëª¨ì§€ë¥¼ í…ìŠ¤íŠ¸ ì˜ì—­ì— ì¶”ê°€
}
</script>

<style>
.emotion-container {
    margin-top: 10px;
}
.emotion-container button {
    margin-right: 5px;
}
#autosaveMessage {
    font-weight: bold;
}
</style>

{% endblock %}
